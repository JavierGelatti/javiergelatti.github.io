<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Live Typing for Ruby | @JavierGelatti online</title>
    <meta name="description" content="Website from @javiergelatti">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.BzdOv6gP.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/client-cXcrl5vC.js"></script>
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><main class="vp-doc"><article class="local-note content-viewer"><div style="position:relative;"><div><h1 id="live-typing-for-ruby" tabindex="-1">Live Typing for Ruby <a class="header-anchor hash" href="#live-typing-for-ruby" aria-label="Permalink to &quot;Live Typing for Ruby&quot;">&#x200b;</a></h1><h2 id="bridging-dynamic-and-static-types" tabindex="-1">Bridging Dynamic and Static Types <a class="header-anchor hash" href="#bridging-dynamic-and-static-types" aria-label="Permalink to &quot;Bridging Dynamic and Static Types&quot;">&#x200b;</a></h2><p>Inspired by Hern&#xe1;n Wilkinson&#x2019;s work on <em>Live Typing</em> in Smalltalk<sup class="footnote-ref"><a href="#fn1" id="fnref1" class="hash">[1]</a></sup>, I developed a system that brings type information to Ruby programs by observing their runtime behavior.</p><p>Here&#x2019;s a description of <em>Live Typing</em>, from Hern&#xe1;n&#x2019;s paper:</p><blockquote><p>Live Typing automatically annotates variable types based on the objects assigned to them, and method return types based on the returned objects. IDEs can exploit this information to greatly improve the development tools and the programming experience, bringing some of the benefits of Static Typing tools to Dynamically Typed Languages.</p></blockquote><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor hash" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">&#x200b;</a></h2><p>The system consists of two main components:</p><ol><li><p><em>The <strong>runtime type information collector</strong></em></p><p>This component observes program execution and records the actual types of variables and method returns as the code runs. It is implemented in Ruby, and is run in the same virtual machine as the program code. The type information is serialized and stored in <code>json</code> format.</p><p>The structure of the saved type data is the following: <img src="/assets/live-typing-structure.CZrv7huU.png" alt="live-typing-structure.png"></p><p>Unlike the Smalltalk implementation, which required modifications to the VM, Ruby&#x2019;s built-in <code>TracePoint</code> API<sup class="footnote-ref"><a href="#fn2" id="fnref2" class="hash">[2]</a></sup> allowed for type collection without low-level modifications.</p></li><li><p><em>The <strong>static type processor</strong></em></p><p>This processes the collected information and presents it embedded on the program source code, through the IDE interface. It is implemented as a RubyMine plugin written in Java.</p></li></ol><h2 id="usage-examples" tabindex="-1">Usage examples <a class="header-anchor hash" href="#usage-examples" aria-label="Permalink to &quot;Usage examples&quot;">&#x200b;</a></h2><p>In this example, we show type annotations for instance variables, methods (parameters + return), including methods defined on metaclasses:</p><iframe width="700" height="400" src="https://www.youtube.com/embed/LWuiZTnGW0I" title="Ruby Live Typing: Example 1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>Here, we show type annotations for methods in an inheritance hierarchy, how the annotations chain when sending messages, and what happens if we try a message for which we don&#x2019;t have any type information.</p><iframe width="700" height="400" src="https://www.youtube.com/embed/W1K9xYSfVvY" title="Ruby Live Typing: Example 2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><h2 id="final-thoughts" tabindex="-1">Final Thoughts <a class="header-anchor hash" href="#final-thoughts" aria-label="Permalink to &quot;Final Thoughts&quot;">&#x200b;</a></h2><p>This project demonstrates how we can enhance development tools for dynamically typed languages without sacrificing their flexibility. By observing actual runtime behavior, we get type information that reflects how the code is really used, rather than relying on static analysis alone.</p><p>The approach could be extended to collect other kinds of runtime information that might be valuable during development, suggesting new possibilities for bridging the gap between development time and runtime in dynamic languages.</p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>You can find more information about this on the paper &#x201c;VM support for live typing: automatic type annotation for dynamically typed languages&#x201d; by Hern&#xe1;n Wilkinson, available <a href="https://dl.acm.org/doi/10.1145/3328433.3328443" target="_blank" rel="noreferrer" class="external">here</a>. <a href="#fnref1" class="footnote-backref hash">&#x21a9;&#xfe0e;</a></p></li><li id="fn2" class="footnote-item"><p>An object-oriented API provided by the Ruby language to trace different events while the program is running, such as method calls and returns. You can find more information about it in the <a href="https://docs.ruby-lang.org/en/master/TracePoint.html" target="_blank" rel="noreferrer" class="external">Ruby documentation</a>. <a href="#fnref2" class="footnote-backref hash">&#x21a9;&#xfe0e;</a></p></li></ol></section></div></div></article><svg xmlns="http://www.w3.org/2000/svg"/></main></div>
    
    
  </body>
</html>